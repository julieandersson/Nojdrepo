/* Produktlistning: layout + filter + toolbar + chips + flyout */
.products-layout {
  display: grid;
  grid-template-columns: 290px 1fr; /* sidebar + innehåll */
  gap: 20px;
  align-items: start;
}

.products-content {
  grid-column: 2;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

/* Sidebar (filtrering) */
.sidebar-filter {
  background: #fff;
  border-radius: 4px;
  box-shadow: 0 2px 2px rgba(0,0,0,.1);
  padding: 25px;
  position: relative;

  .filter-close { display: none; } /* syns i flyout */

  h4 {
    margin: 0 0 6px 0;
    font-size: 18px;
    font-weight: 700;

    &.filter-title {
      display: inline-flex;
      align-items: center;
      gap: 8px;

      .icon-filter {
        width: 18px;
        height: 18px;
        stroke: currentColor;
        fill: none;
        flex: 0 0 auto;
      }
    }
  }

  form {
    display: flex;
    flex-direction: column;
    gap: 18px;
  }

  .active-filters {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    gap: 10px;
    margin: 10px 0 18px;

    .chips {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .clear-filters-top {
      align-self: flex-start;
      margin-left: 0;
    }
  }
}

/* filter-footer (av) på desktop */
.filter-footer { display: none; }

/* Filtergrupper */
.filter-group { display: flex; flex-direction: column; }

.filter-label {
  font-weight: 700;
  font-size: 14px;
  margin-bottom: 8px;
  display: block;
}

.checkbox-group {
  display: flex; flex-direction: column; gap: 6px;

  label {
    display: flex; align-items: center; gap: 10px;
    font-weight: 400; font-size: 14px; line-height: 1.3;
    cursor: pointer; padding: 6px 8px; border-radius: 4px;
    transition: background-color .15s ease, box-shadow .15s ease;

    &:hover { background-color: #f6f6f6; }

    &:has(input[type="checkbox"]:disabled) {
      cursor: not-allowed; opacity: .7;
    }
  }

  input[type="checkbox"] { width: 16px; height: 16px; accent-color: #222; }

  input[type="checkbox"]:checked + span,
  label:has(input[type="checkbox"]:checked) { background-color: #f2f6ff; }

  input[type="checkbox"]:disabled ~ * { color: #aaa; }
}

/* toolbar över gridet */
.products-toolbar {
  display: flex;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  justify-content: flex-start;

  .sort-controls { display:flex; align-items:center; flex-wrap:wrap; flex:0 0 auto; margin-right: 25px; }

  .sort-label { font-size: 14px; font-weight: 600; display: flex; align-items: center; gap: 10px; }

  .sort-select {
    background: #fff; border: 1px solid #ccc; border-radius: 4px;
    padding: 9px 12px; font-size: 14px; min-width: 170px; line-height: 1; cursor: pointer;
  }

  .searchbar {
    position: relative;
    flex: 1 1 260px;
    max-width: 480px;
    min-width: 220px;

    .search-input {
      width: 100%;
      padding: 10px 12px 10px 36px;
      border: 1px solid #ccc; border-radius: 4px;
      font-size: 14px; line-height: 1.2; background: #fff;

      &:focus { outline: none; border-color: #999; }
    }

    .search-icon2 {
      position: absolute; left: 10px; top: 50%; transform: translateY(-50%);
      width: 18px; height: 18px; color: #777; pointer-events: none;
    }
  }

  .toolbar-right {
    display: flex; align-items: center; gap: 12px; margin-left: auto;

    .view-toggle { display: flex; align-items: center; gap: 10px; }
    .view-toggle i { font-size: 30px; color: #939393; cursor: pointer; transition: color .15s ease; }
    .view-btn { border: none; background: none; padding: 4px; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; }
    .view-btn:hover { background: none; }
    .view-btn.is-active i { color: #000; }

    .filter-toggle {
      display: none; /* visas i mobil */
      align-items: center; gap: 8px;
      padding: 10px 14px; border: 1px solid #ccc; border-radius: 4px; background: #fff;
      cursor: pointer; font-weight: 600; line-height: 1;

      .icon-filter, svg {
        width: 18px; height: 18px; stroke: currentColor; fill: none; display: inline-block; flex: 0 0 auto;
      }

      &:hover { background-color: #f6f6f6; }
    }
  }
}

/* chips under toolbaren (i innehållskolumnen) */
.active-filters {
  display: flex; align-items: center; gap: 12px; margin-bottom: 16px;
  flex-wrap: wrap; justify-content: flex-start;

  &[hidden] { display: none; }

  .chips { display: flex; flex-wrap: wrap; gap: 12px; flex: 1 1 auto; min-width: 0; }

  .filter-chip {
    display: inline-flex; align-items: center; gap: 2px; padding: 0 10px;
    border: 1px solid #bbb; border-radius: 4px; background: #fff; font-size: 13px; white-space: nowrap;

    .chip-close {
      display: inline-flex; align-items: center; justify-content: center;
      width: 22px; height: 22px; border: none; background: none;
      cursor: pointer; font-size: 20px; line-height: 1;
    }
  }

  .clear-filters-top {
    background: none; border: none; color: #b31217; font-weight: 700; cursor: pointer; padding: 0;
    margin-left: auto; flex: 0 0 auto; white-space: nowrap;

    &:hover { text-decoration: underline; }
  }
}

/* backdrop för flyout */
.filter-backdrop {
  position: fixed; inset: 0; background-color: rgba(0,0,0,.5);
  z-index: 9998; display: none; opacity: 0; transition: opacity .3s ease-in-out;

  &.visible { display: block; opacity: 1; }
}

@media (max-width: 1206px) {
  /* textjustering i content */
  p { font-size: 14px; }

  .products-layout { grid-template-columns: 1fr; }
  .products-content { grid-column: auto; }

  .products-toolbar {
    .searchbar { flex: 1 1 100%; max-width: none; }
    .toolbar-right .filter-toggle { display: inline-flex; }
    justify-content: flex-start;

    .sort-controls { order: 1; flex: 1 1 100%; }
    .searchbar     { order: 2; min-width: 0; }
    .toolbar-right { order: 2; margin-left: auto; }
  }

  .sidebar-filter {
    position: fixed; top: 0; right: 0; left: auto;
    height: 100dvh; width: min(92vw, 400px);
    overflow: auto; z-index: 9999;
    transform: translateX(100%); transition: none; box-shadow: 0 2px 2px rgba(0,0,0,.1); border-radius: 0;

    &.is-open   { transform: translateX(0);   transition: transform .3s ease-in-out; }
    &.closing   { transform: translateX(100%); transition: transform .3s ease-in-out; }
  }

  .filter-footer {
    display: flex; align-items: center; gap: 8px;
    position: sticky; bottom: 0; background: #fff; padding: 7px; z-index: 1;

    .clear-filters-bottom {
      padding: 12px 12px; border-radius: 4px; border: none; background: #000; color: #fff; font-weight: 600; cursor: pointer; flex: 0 0 auto;

      &:disabled { opacity: .6; cursor: not-allowed; }
    }

    .show-products {
      width: auto; padding: 12px 16px; border: 1px solid #ccc; border-radius: 4px; background: #fff; font-weight: 600; cursor: pointer; flex: 1 1 auto;

      &:hover { background: #f5f5f5; }
    }
  }
}

@media (max-width: 735px) {
  .products-toolbar {
    .sort-select { min-width: 0; width: 120px; padding: 5px 10px; }
    .sort-label, .sort-select { font-size: 13px; }
    .filter-toggle { padding: 5px 12px; font-size: 13px; }
    .searchbar .search-input { padding: 6px 12px 5px 36px; font-size: 13px; }
  }
}

@media (max-width: 664px) {
  .products-toolbar .sort-controls { gap: 5px; }
}

@media (max-width: 577px) {
  .view-btn[data-view="list"] { display: none !important; }
}

@media screen and (max-width: 410px) {
  .sidebar-filter {
    width: 360px;
  }
}

@media screen and (max-width: 380px) {
  .sidebar-filter {
    width: 340px;
  }
}